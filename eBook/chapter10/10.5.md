# 通过共享变量来共享内存

**通过共享变量来共享内存** 是 Unix 线程间彼此通信非常普通的方式。一个 **互斥** 变量是一个互相排斥变量的简称，它主要用于线程同步和在有多个写操作同时发生时保护共享数据。互斥工作类似于容量为一的 **缓冲通道**，它允许最多一个 goroutine 在任何给定时间访问共享变量。这就是说没有办法让俩个或更多 goroutines 同时去更新一个变量。

一个并发程序的 **关键部分** 是代码不能被所有进程，线程或如当前的所有 goroutines 同时执行。代码需要用互斥体保护起来。因此，识别代码的关键部分会使整个程序处理非常简单，您应该注意这个任务。

> *当两个关键部分使用相同的 `sync.Mutex` 或 `sync.RWMutex` 变量时，您不能把其中一个嵌入另一个。不惜任何代价一定要避免跨函数传播互斥体，因为那会很难看出您是否做了嵌套。*

下面两小节将说明 `sync.Mutex` 和 `sync.RWMutex` 类型的使用。